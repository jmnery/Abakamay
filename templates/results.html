{% extends 'base.html' %} {% block title %}Results{% endblock %} {% block
content %}
<style>
  .container-results {
    height: 100vh;
    padding: 30px;
    padding-top: 80px;
    padding-bottom: 10px;
    box-sizing: border-box;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  .score-card,
  .details-card {
    height: auto;
  }

  .results-card {
    height: auto;
  }

  .table {
    border: 2px solid var(--black);
    color: white;
    width: 100%;
  }

  .table th,
  .table td {
    border: 2px solid var(--black);
    vertical-align: middle;
    text-align: center;
  }

  .table thead {
    background-color: var(--black);
  }

  .table-responsive {
    height: calc(100vh - 150px);
    overflow-y: auto;
  }

  .result-image {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
  }

  .correct-answer {
    background-color: var(--light-green);
  }

  .correct-answer:hover {
    background-color: var(--green);
  }

  .incorrect-answer {
    background-color: var(--light-red);
  }

  .incorrect-answer:hover {
    background-color: var(--red);
  }

  /* Flex styling for left side titles and right side values */
  .data-row {
    display: flex;
    justify-content: space-between;
    padding: 5px 0;
  }

  .data-title {
    font-weight: bold; /* Bold for titles */
  }

  .divider {
    border-top: 1px solid #ccc;
    margin: 10px 0;
  }
</style>

<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
  <a class="navbar-brand" href="#">Results</a>
  <button
    class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#navbarNav"
    aria-controls="navbarNav"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('learn') }}">Learn</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="{{ url_for('quiz') }}">Quiz</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="{{ url_for('collection') }}">Collection</a>
      </li>
      <li class="nav-item dropdown">
        <a
          class="nav-link dropdown-toggle d-flex align-items-center"
          id="avatarDropdown"
          role="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <img
            src="{{ avatar or 'https://via.placeholder.com/50' }}"
            alt="Avatar"
            class="rounded-circle"
            style="width: 35px; height: 35px; margin-right: 5px"
          />
        </a>
        <ul class="dropdown-menu" aria-labelledby="avatarDropdown">
          <li>
            <a class="dropdown-item" href="{{ url_for('profile') }}">Profile</a>
          </li>
          <li><hr class="dropdown-divider" /></li>
          <li>
            <a class="dropdown-item" href="{{ url_for('logout') }}">Logout</a>
          </li>
        </ul>
      </li>
    </ul>
  </div>
</nav>

<div class="container-results">
  <div class="row flex-grow-1">
    <!-- Left Column -->
    <div class="col-md-4">
      <!-- Quiz Results Card -->
      <div class="card score-card mb-4">
        <h5 class="card-header">Quiz Results</h5>
        <div class="card-body">
          <div class="data-row">
            <span class="data-title">Your Score:</span>
            <span>{{ result_data.score }}%</span>
          </div>
          <div class="divider"></div>
          <div class="data-row">
            <span class="data-title">Correct Answers:</span>
            <span
              >{{ result_data.correct_answers }} / {{
              result_data.total_questions }}</span
            >
          </div>
        </div>
      </div>

      <!-- Quiz Details Card -->
      <div class="card details-card mb-4">
        <h5 class="card-header">Quiz Details</h5>
        <div class="card-body">
          <div class="data-row">
            <span class="data-title">Quiz ID:</span>
            <span>{{ result_data.quiz_ID }}</span>
          </div>
          <div class="divider"></div>
          <div class="data-row">
            <span class="data-title">Quiz Date:</span>
            <span>{{ result_data.timestamp.date }}</span>
          </div>
          <div class="divider"></div>
          <div class="data-row">
            <span class="data-title">Quiz Time:</span>
            <span>{{ result_data.timestamp.time }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-md-8">
      <div class="card results-card mb-4 h-100">
        <h5 class="card-header">Quiz Results</h5>
        <div class="card-body">
          <div class="table-responsive">
            {% if result_data.user_answers and result_data.quiz_words %}
            <table class="table table-bordered">
              <thead class="thead-dark">
                <tr>
                  <th>Image</th>
                  <th>Letter</th>
                  <th>Syllable</th>
                  <th>Word</th>
                  <th>Your Answer</th>
                </tr>
              </thead>
              <tbody>
                {% for result in result_data.user_answers %}
                <tr
                  class="{% if result.correct %}correct-answer{% else %}incorrect-answer{% endif %}"
                >
                  <td>
                    {% if result.word.extension %}
                    <img
                      src="https://firebasestorage.googleapis.com/v0/b/abakada-flask.appspot.com/o/{{ result.word.text }}{{ result.word.extension }}?alt=media"
                      class="result-image"
                      alt="{{ result.word.text }}"
                    />
                    {% endif %}
                  </td>
                  <td>{{ result.word.letter }}</td>
                  <td>{{ result.word.syllable }}</td>
                  <td>{{ result.word.text }}</td>
                  <td>{{ result.user_answer.replace(' ', '-') }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <div class="alert alert-warning" role="alert">
              No results to display.
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  const data = {{ result_data | tojson }};
  console.log("Quiz Date:", data.timestamp.date);
  console.log("Quiz Time:", data.timestamp.time);
</script>
{% endblock %}
